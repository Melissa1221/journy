# JOURNI ğŸŒâœ¨

![Next.js](https://img.shields.io/badge/Next.js-16-black?style=for-the-badge&logo=next.js)
![React](https://img.shields.io/badge/React-19-61DAFB?style=for-the-badge&logo=react&logoColor=black)
![Supabase](https://img.shields.io/badge/Supabase-3ECF8E?style=for-the-badge&logo=supabase&logoColor=white)
![FastAPI](https://img.shields.io/badge/FastAPI-009688?style=for-the-badge&logo=fastapi&logoColor=white)
![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white)
![Python](https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white)

> **Viajar con amigos no deberÃ­a terminar en hojas de cÃ¡lculo interminables.**
> JOURNI convierte el caos de los gastos grupales en **transparencia total**, mientras captura cada momento especial del viaje.

<div align="center">
  <video src="./public/assets/demo/demo-uso.mp4" controls width="100%"></video>
  <p><em>Demo en vivo: Dos usuarios interactuando en tiempo real en la plataforma web</em></p>
</div>

---

## ğŸ¯ El Problema

Organizar un viaje grupal hoy significa:

- ğŸ“Š **Hojas de cÃ¡lculo infinitas**: "Â¿QuiÃ©n pagÃ³ el taxi? Â¿Dividimos el almuerzo?"
- ğŸ’¸ **Cuentas confusas**: "Creo que me debes... Â¿o te debo yo?"
- ğŸ“± **Apps fragmentadas**: WhatsApp para fotos, Excel para gastos, Google Maps para ubicaciones
- ğŸ˜° **EstrÃ©s al final del viaje**: "Dame 3 dÃ­as para calcular quiÃ©n debe a quiÃ©n"

**El resultado:** Amistades tensas y recuerdos empaÃ±ados por discusiones de dinero.

---

## âœ¨ La SoluciÃ³n: JOURNI

JOURNI es la **plataforma todo-en-uno** para viajes grupales que combina:

### ğŸ§  IA Conversacional para Gastos
OlvÃ­date de formularios. Solo habla naturalmente:
- *"PaguÃ© 50 soles del taxi"* â†’ âœ… Gasto registrado
- *"Juan pagÃ³ 100 del almuerzo para todos"* â†’ âœ… AutomÃ¡ticamente dividido
- *"Â¿CuÃ¡nto debo?"* â†’ ğŸ’° Balance instantÃ¡neo
- *"Edita el gasto del taxi a 60"* â†’ âœï¸ Corregido

<div align="center">
  <video src="./public/assets/demo/chatbot-wsp.mp4" controls width="100%"></video>
  <p><em>Chatbot en WhatsApp: Gestiona tus gastos desde donde estÃ©s</em></p>
</div>

### ğŸ“¸ Ãlbum de Recuerdos Vivo
- Sube fotos mientras viajas
- OrganÃ­zalas por **Momentos** (dÃ­as, lugares, eventos)
- Etiqueta ubicaciones en el **mapa interactivo**
- Revive tu viaje en una lÃ­nea de tiempo visual

### ğŸ’° CÃ¡lculo AutomÃ¡tico de Balances
- **MÃºltiples monedas**: PEN, CLP, USD, EUR, ARS, BRL, COP
- **OptimizaciÃ³n de deudas**: Minimiza las transferencias necesarias
- **Transparencia total**: Todos ven lo mismo en tiempo real

### âš¡ Tiempo Real para Todos
- Chat grupal sincronizado
- Actualizaciones instantÃ¡neas de gastos
- Indicadores de presencia (quiÃ©n estÃ¡ en lÃ­nea)
- Sin recargas, sin confusiones

---

## ğŸš€ CaracterÃ­sticas Principales

### 1. ğŸ—£ï¸ Asistente IA con 12 Herramientas Especializadas

Nuestro agente basado en **LangGraph** no solo entiende texto, sino que **actÃºa**:

**GestiÃ³n de Gastos:**
- âœ… Registrar gastos con lenguaje natural
- âœï¸ Editar gastos existentes
- ğŸ—‘ï¸ Eliminar gastos
- ğŸ“‹ Listar todos los gastos del viaje

**Balances y Pagos:**
- ğŸ’µ Consultar balances individuales o grupales
- ğŸ”„ Calcular liquidaciones optimizadas ("Â¿quiÃ©n le paga a quiÃ©n?")
- ğŸ’¸ Registrar pagos entre usuarios (*"Le paguÃ© 30 a Pedro"*)

**Fotos y Recuerdos:**
- ğŸ“· Crear hitos/momentos del viaje
- ğŸ–¼ï¸ Subir fotos a los momentos
- ğŸ—ºï¸ Etiquetar ubicaciones
- ğŸ‘ï¸ Analizar fotos con visiÃ³n artificial (GPT-4o)

![Chat con IA](./public/assets/balance-illustration.png)
*Ejemplo: ConversaciÃ³n natural para registrar gastos*

---

### 2. ğŸ“Š Dashboard Inteligente

**Tarjeta Hero del Viaje Activo:**
- Barra de progreso (dÃ­a X de Y)
- Portada visual personalizada
- Acceso rÃ¡pido al chat y funciones

**EstadÃ­sticas RÃ¡pidas:**
- ğŸ’° Total gastado en el viaje
- ğŸ”¢ Tu balance (debes/te deben)
- ğŸ“¸ Cantidad de fotos subidas
- ğŸ“ Lugares visitados
- â­ Momentos creados

**Acciones RÃ¡pidas:**
- Agregar gasto
- Subir foto
- Ver mapa de recuerdos
- Compartir cÃ³digo del viaje

![Dashboard](./public/assets/hero-landscape.png)
*Vista del dashboard con estadÃ­sticas del viaje*

---

### 3. ğŸ—ºï¸ Mapa Interactivo de Recuerdos

- **Marcadores de ubicaciones** visitadas
- **VisualizaciÃ³n temporal** de tu ruta
- **Fotos geoetiquetadas** en cada lugar
- **NavegaciÃ³n fluida** entre momentos

![Mapa de Recuerdos](./public/assets/map-background.png)
*Visualiza tu viaje en un mapa interactivo*

---

### 4. ğŸ’¬ Chat Grupal en Tiempo Real

**WebSocket Multiusuario:**
- Mensajes instantÃ¡neos para todos los participantes
- Respuestas de IA en streaming
- Indicadores de escritura
- Soporte para imÃ¡genes (recibos, fotos)

**Tipos de Mensajes:**
- ğŸ‘¤ Mensajes de usuarios
- ğŸ¤– Respuestas del asistente IA
- ğŸ“¥ Notificaciones de entrada/salida
- ğŸ–¼ï¸ ImÃ¡genes compartidas (base64)

<div align="center">
  <img src="./public/assets/demo/wsp-link.jpeg" width="80%" alt="WhatsApp Link - ConÃ©ctate desde WhatsApp" />
  <p><em>IntegraciÃ³n con WhatsApp para uso sin fricciones</em></p>
</div>

---

### 5. ğŸ”— Invitaciones Sin FricciÃ³n

- **CÃ³digo de 6 caracteres** Ãºnico por viaje
- **Modo invitado anÃ³nimo**: Ãšnete sin crear cuenta
- **Compartir en un clic**: Link directo al viaje
- **Lista de participantes** con avatares

![Compartir Viaje](./public/assets/money-friends-illustration.png)
*Invita a tus amigos con un cÃ³digo simple*

---

### 6. ğŸ“ˆ AnÃ¡lisis de Gastos Avanzado

**CÃ¡lculo de Balances:**
```
Balance = Total Pagado - Parte Justa
â€¢ Balance negativo = Debes dinero
â€¢ Balance positivo = Te deben dinero
```

**OptimizaciÃ³n de Deudas:**
- SeparaciÃ³n por moneda
- Algoritmo greedy para minimizar transacciones
- Plan de pagos simplificado

**Visualizaciones:**
- GrÃ¡ficos de torta con Recharts
- Desglose por persona
- Totales por moneda

---

## ğŸ› ï¸ Stack TecnolÃ³gico

### Frontend
| TecnologÃ­a | VersiÃ³n | PropÃ³sito |
|------------|---------|-----------|
| **Next.js** | 16.0.5 | Framework React con App Router |
| **React** | 19.2.0 | Biblioteca UI |
| **TypeScript** | 5.x | Desarrollo type-safe |
| **Tailwind CSS** | 3.4.17 | Estilos utility-first |
| **Framer Motion** | 12.23.24 | Animaciones fluidas |
| **Radix UI** | Latest | Componentes accesibles |
| **React Query** | 5.83.0 | GestiÃ³n de estado del servidor |
| **Supabase Client** | 2.86.0 | Cliente de base de datos y auth |
| **Recharts** | 2.15.4 | VisualizaciÃ³n de datos |
| **XY Flow** | 12.9.3 | GrÃ¡ficos interactivos |

### Backend
| TecnologÃ­a | VersiÃ³n | PropÃ³sito |
|------------|---------|-----------|
| **Python** | 3.11+ | Lenguaje backend |
| **FastAPI** | Latest | Framework web async |
| **LangGraph** | Latest | OrquestaciÃ³n de agentes IA |
| **LangChain** | Latest | IntegraciÃ³n con LLMs |
| **Uvicorn** | Latest | Servidor ASGI |
| **Pydantic** | Latest | ValidaciÃ³n de datos |

### IA
- **GPT-4o** (Principal): Capacidades multimodales con visiÃ³n
- **GPT-4o-mini** (Secundario): Fallback mÃ¡s rÃ¡pido
- **Claude** (Terciario): Fallback alternativo
- **Gemini** (Cuaternario): Fallback adicional

### Infraestructura
- **Supabase**: Base de datos PostgreSQL, autenticaciÃ³n, almacenamiento
- **Railway**: Despliegue del backend
- **Vercel**: Hosting del frontend (recomendado)

---

## ğŸ“‚ Estructura del Proyecto

```
my-app/
â”œâ”€â”€ backend/                          # Backend FastAPI + Python
â”‚   â”œâ”€â”€ main.py                      # Servidor con WebSocket y HTTP
â”‚   â”œâ”€â”€ graph.py                     # Agente LangGraph con 12 herramientas IA
â”‚   â”œâ”€â”€ room_manager.py              # GestiÃ³n de salas WebSocket
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ supabase_db.py           # Persistencia de estado
â”‚   â”‚   â”œâ”€â”€ supabase_storage.py      # Almacenamiento de fotos
â”‚   â”‚   â””â”€â”€ session_service.py       # GestiÃ³n de sesiones
â”‚   â””â”€â”€ requirements.txt             # Dependencias Python
â”‚
â”œâ”€â”€ src/                             # Frontend Next.js
â”‚   â”œâ”€â”€ app/                         # App Router (Next.js 13+)
â”‚   â”‚   â”œâ”€â”€ page.tsx                 # Landing page
â”‚   â”‚   â”œâ”€â”€ auth/                    # PÃ¡ginas de autenticaciÃ³n
â”‚   â”‚   â”œâ”€â”€ dashboard/               # Dashboard principal
â”‚   â”‚   â”œâ”€â”€ create-session/          # Crear viaje
â”‚   â”‚   â”œâ”€â”€ join/[code]/             # Unirse con cÃ³digo
â”‚   â”‚   â”œâ”€â”€ session/[id]/            # Chat y gastos del viaje
â”‚   â”‚   â””â”€â”€ trip/[id]/               # Detalles y anÃ¡lisis
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ chat/                    # Componentes de chat
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatConversation.tsx # Ãrea de mensajes
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx        # Input con subida de imÃ¡genes
â”‚   â”‚   â”‚   â””â”€â”€ ChatMessage.tsx      # Mensaje individual
â”‚   â”‚   â”œâ”€â”€ TripExpenses.tsx         # Lista de gastos
â”‚   â”‚   â”œâ”€â”€ TripMemoryMap.tsx        # Mapa interactivo
â”‚   â”‚   â”œâ”€â”€ TripMoments.tsx          # Ãlbum de fotos
â”‚   â”‚   â””â”€â”€ ui/                      # 50+ componentes Radix UI
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useJourniChat.ts         # Hook de chat WebSocket
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â””â”€â”€ AuthContext.tsx          # Contexto de autenticaciÃ³n
â”‚   â”‚
â”‚   â””â”€â”€ assets/                      # ImÃ¡genes estÃ¡ticas
â”‚
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ migrations/                  # 7 migraciones de BD
â”‚       â”œâ”€â”€ 001_initial_schema.sql   # Esquema base
â”‚       â”œâ”€â”€ 002_rls_policies.sql     # Seguridad Row-Level
â”‚       â””â”€â”€ ...                      # MÃ¡s migraciones
â”‚
â””â”€â”€ Documentation/                   # DocumentaciÃ³n completa
    â”œâ”€â”€ COMPREHENSIVE_DOCUMENTATION.md
    â”œâ”€â”€ DATABASE_SETUP_GUIDE.md
    â””â”€â”€ ...
```

---

## ğŸ—„ï¸ Esquema de Base de Datos

### 8 Tablas Principales

1. **users** - Perfiles de usuario (extiende Supabase Auth)
2. **trips** - Metadata de viajes con cÃ³digos Ãºnicos
3. **trip_participants** - Participantes por viaje
4. **expenses** - Todos los gastos registrados
5. **expense_splits** - DivisiÃ³n de gastos
6. **chat_messages** - Historial del chat grupal
7. **photos** - Metadatos del Ã¡lbum de fotos
8. **locations** - Lugares visitados para el mapa

### Seguridad
- âœ… **Row Level Security (RLS)** en todas las tablas
- âœ… Solo ves tus propios viajes
- âœ… VerificaciÃ³n automÃ¡tica de permisos
- âœ… 35 polÃ­ticas de seguridad implementadas

### CaracterÃ­sticas AutomÃ¡ticas
1. **DivisiÃ³n automÃ¡tica de gastos** entre participantes
2. **Timestamps automÃ¡ticos** (created_at, updated_at)
3. **CÃ¡lculo de balances** con vista `user_trip_balances`
4. **Generador de cÃ³digos** con funciÃ³n `generate_session_code()`

---

## ğŸ Empezando

### Prerrequisitos
- Node.js 18+
- Python 3.11+
- Cuenta de Supabase
- API Key de OpenAI

### InstalaciÃ³n

#### 1. **Clonar el Repositorio**
```bash
git clone <tu-repositorio>
cd my-app
```

#### 2. **Configurar Variables de Entorno**

Crea `.env.local` en la raÃ­z:
```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=tu_url_de_supabase
NEXT_PUBLIC_SUPABASE_ANON_KEY=tu_clave_anon

# OpenAI
OPENAI_API_KEY=tu_api_key_de_openai

# Backend (opcional para desarrollo local)
NEXT_PUBLIC_BACKEND_URL=http://localhost:8000
```

Crea `.env` en `/backend`:
```env
OPENAI_API_KEY=tu_api_key_de_openai
SUPABASE_URL=tu_url_de_supabase
SUPABASE_KEY=tu_service_role_key
```

#### 3. **Configurar Base de Datos**

1. Crea un proyecto en [Supabase](https://supabase.com)
2. Ejecuta las migraciones en orden:
   ```bash
   # En el SQL Editor de Supabase, ejecuta cada archivo en orden:
   # 001_initial_schema.sql
   # 002_rls_policies.sql
   # 003_views_and_functions.sql
   # 004_milestones_table.sql
   # 005_photos_milestone_link.sql
   # 006_anonymous_sessions.sql
   # 007_user_sync_trigger.sql
   ```
3. Configura autenticaciÃ³n por email en Supabase Authentication

<div align="center">
  <img src="./public/assets/demo/AUTH_SETUP.jpeg" width="90%" alt="ConfiguraciÃ³n de AutenticaciÃ³n en Supabase" />
  <p><em>ConfiguraciÃ³n de autenticaciÃ³n en Supabase Dashboard</em></p>
</div>

#### 4. **Frontend - InstalaciÃ³n y EjecuciÃ³n**
```bash
# Instalar dependencias
pnpm install

# Ejecutar servidor de desarrollo
pnpm dev

# Abrir http://localhost:3000
```

#### 5. **Backend - InstalaciÃ³n y EjecuciÃ³n**
```bash
cd backend

# Crear entorno virtual
python -m venv .venv
source .venv/bin/activate  # En Windows: .venv\Scripts\activate

# Instalar dependencias
pip install -r requirements.txt

# Ejecutar servidor
python main.py

# Servidor corriendo en http://localhost:8000
```

---

## ğŸ“¡ API Endpoints

### WebSocket (Tiempo Real)
```
ws://localhost:8000/ws/{thread_id}/{user_id}
```
ConexiÃ³n de chat en tiempo real para mensajerÃ­a multiusuario.

### HTTP

**Chat/Mensajes:**
```http
POST /api/chat
Content-Type: application/json

{
  "messages": [
    {"role": "user", "content": "PaguÃ© 50 del taxi"}
  ],
  "id": "session-123"
}
```

**Estado de SesiÃ³n:**
```http
GET /api/sessions/{thread_id}
```
Obtiene estado completo (gastos, balances, participantes).

**Health Check:**
```http
GET /
```

---

## ğŸ¨ Sistema de DiseÃ±o

### Paleta de Colores (Tema Viaje & Atardecer)

| Color | Hex | Uso |
|-------|-----|-----|
| **Coral Principal** | `#FF8750` | Botones, acciones primarias |
| **Verde Naturaleza** | `#B9E88A` | Badges, estados de Ã©xito |
| **Azul Cielo** | `#BEE5FF` | Tema de viaje, calma |
| **Crema CÃ¡lido** | `#FFF7F0` | Fondos de tarjetas |
| **Verde Suave** | `#DDEFC4` | Fondo de la app |
| **Texto Oscuro** | `#2F2F3A` | Texto principal |

### FilosofÃ­a de DiseÃ±o
- âœ¨ EstÃ©tica cÃ¡lida e invitadora para viajes
- ğŸ˜Š ComunicaciÃ³n visual basada en emojis
- ğŸ­ Animaciones suaves con Framer Motion
- ğŸ“± DiseÃ±o mobile-first responsive
- â™¿ Contraste accesible y tipografÃ­a clara

---

## ğŸš€ Despliegue

### Frontend (Vercel - Recomendado)
```bash
# Instalar Vercel CLI
pnpm i -g vercel

# Desplegar
vercel

# Variables de entorno a configurar en Vercel:
# - NEXT_PUBLIC_SUPABASE_URL
# - NEXT_PUBLIC_SUPABASE_ANON_KEY
# - NEXT_PUBLIC_BACKEND_URL (URL de Railway)
```

### Backend (Railway)
1. Crear nuevo proyecto en [Railway](https://railway.app)
2. Conectar repositorio GitHub
3. Configurar variables de entorno:
   - `OPENAI_API_KEY`
   - `SUPABASE_URL`
   - `SUPABASE_KEY`
4. Railway detecta automÃ¡ticamente FastAPI con Nixpacks
5. Comando de inicio: `uvicorn main:app --host 0.0.0.0 --port $PORT`

---

## ğŸ§ª Testing

### Backend
```bash
cd backend
pytest tests/test_graph.py -v
```

Pruebas incluidas:
- âœ… Registro de gastos
- âœ… CÃ¡lculo de balances
- âœ… OptimizaciÃ³n de deudas
- âœ… GestiÃ³n de fotos
- âœ… CreaciÃ³n de momentos

---

## ğŸ¤ Contribuir

Las contribuciones son bienvenidas. Por favor:

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

---

## ğŸ“„ Licencia

Este proyecto es privado y estÃ¡ en desarrollo activo.

---

## ğŸ‘¥ Equipo

Desarrollado con â¤ï¸ para el Hackathon AI PerÃº 2025

---

## ğŸ”— Links Ãštiles

- [DocumentaciÃ³n de Next.js](https://nextjs.org/docs)
- [DocumentaciÃ³n de Supabase](https://supabase.com/docs)
- [LangGraph Documentation](https://python.langchain.com/docs/langgraph)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)

---

<div align="center">
  <strong>Â¿Listo para viajar sin estrÃ©s financiero?</strong><br>
  <em>Ãšnete a JOURNI y transforma tus viajes grupales</em>
</div>
